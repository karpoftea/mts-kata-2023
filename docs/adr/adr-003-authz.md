- [Title](#title)
- [Status](#status)
- [Context](#context)
- [Decision](#decision)

# Title
Механизм авторизации

# Status
Proposed

# Context
В системе явным образом выделаяется набор ролей, которые определяют полномочия пользователей:
- Гость: просматривает/участвует в курсах/уроках/активностях доступных из неавторизованной зоны
- Студент: просматривает/участвует в курсах/уроках/активностях доступных из авторизованной зоны
- Преподаватель: оцениват дипломные работы
- Администратор/СотрудникПоддержки: управляет пользователями/ролями, организует структуру курса/урока

Нужно разграничить доступы к функционалу согласно ролевой можели.

Также необходимо изолировать данные одних Студентов от других.

# Decision
Мы будем назначать роли для каждого пользователя при регистрации и использовать их для авторизации запросов. Роли будут глобальными, то каждый сервис будет ассоциировать с ролью набор привилегий, хранение роли будет централизовано в API Gateway.

API Gateway будет хранить базу пользователей, аутентифицировать их (в МТС ID), управлять регистрацией и назначением ролей, передавать информацию о пользователях в доменные сервисы в заголовке (в частности о их роли). Мы намеренно совмещаем функции API Gateway и управление пользователями/ролями на этом этапе, поскольку это позволит быстро реализовать ролевую модель.

Авторизация запросов будет происходить на сервисах, это позволит развивать ролевую модель на уровне сервиса независимо от других компонент.

Для изоляции данных студентов мы будем для каждого студента генерировать уникальное имя корневого каталога в котором будут храниться его данные. Все запросы к данным (домашних заданий) студента мы будем рассматривать в рамках этого каталога.